<div class="filter-wrapper">
  <mat-form-field class="filter-field">
    <input matInput type="text" placeholder="Filter" [formControl]="filterFormControl">
    <button class="clear-button"
            mat-button
            *ngIf="filterFormControl.value"
            matSuffix
            mat-icon-button
            aria-label="Clear" (click)="clearFilter()">
      x
    </button>
  </mat-form-field>
</div>
<mat-accordion displayMode="flat">
  <mat-expansion-panel *ngFor="let menuItem of menu"
                       (opened)="menuItem.panelOpenState = true"
                       (closed)="menuItem.panelOpenState = undefined">
    <mat-expansion-panel-header collapsedHeight="45px" expandedHeight="60px">
      <mat-panel-description>
        <div [ngClass]="{'active-item': menuItem.panelOpenState}">{{menuItem.name | uppercase}}</div>
      </mat-panel-description>
    </mat-expansion-panel-header>

    <div [ngSwitch]="!!menuItem.sub_areas">
      <mat-accordion displayMode="flat" *ngSwitchCase="true">
        <mat-expansion-panel *ngFor="let subMenuItem of menuItem.sub_areas"
                             (opened)="subMenuItem.panelOpenState = true"
                             (closed)="subMenuItem.panelOpenState = undefined">
          <mat-expansion-panel-header collapsedHeight="45px" expandedHeight="45px">
            <mat-panel-description>
              <div [ngClass]="{'active-item': subMenuItem.panelOpenState}">
                {{subMenuItem.name | uppercase}}
              </div>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <div class="collapse-menu-content">
            <div class="question-item"
                 [ngClass]="{completed: question.is_complete}"
                 *ngFor="let question of subMenuItem.questions"
                 routerLink="/answer/{{question.answer_id}}">
              {{question.display_code + ' ' + question.name}}
            </div>
          </div>
        </mat-expansion-panel>
      </mat-accordion>
      <div *ngSwitchCase="false">
        <div class="collapse-menu-content">
          <div class="question-item"
               [ngClass]="{completed: question.is_complete}"
               *ngFor="let question of menuItem.questions"
               routerLink="/answer/{{question.answer_id}}">
            {{question.display_code + ' ' + question.name}}
          </div>
        </div>
      </div>
    </div>
  </mat-expansion-panel>
</mat-accordion>
